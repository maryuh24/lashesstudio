<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Forgot Password - LashStudio</title>
  <link rel="stylesheet" href="css/style.css">
  <style>
    /* Navy Blue Button Container Styles */
    .navy-step-container {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      padding: 1.5rem;
      background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
      border-radius: 1rem;
      border: 2px solid #e2e8f0;
      box-shadow: 0 4px 6px rgba(30, 58, 138, 0.08);
      transition: all 0.3s ease;
      margin-bottom: 1rem;
    }

    .navy-step-container:hover {
      border-color: #cbd5e1;
      box-shadow: 0 8px 12px rgba(30, 58, 138, 0.12);
    }

    .navy-step-container input[type="email"],
    .navy-step-container input[type="text"],
    .navy-step-container input[type="password"] {
      width: 100%;
      padding: 0.875rem 1.25rem;
      background: #ffffff;
      border: 2px solid #e2e8f0;
      border-radius: 0.625rem;
      color: #1e3a8a;
      font-size: 1rem;
      font-weight: 500;
      transition: all 0.3s ease;
      outline: none;
    }

    .navy-step-container input::placeholder {
      color: #94a3b8;
      font-weight: 400;
    }

    .navy-step-container input:focus {
      border-color: #1e3a8a;
      background: #f8fafc;
      box-shadow: 0 0 0 4px rgba(30, 58, 138, 0.1);
    }

    .navy-step-container input:hover:not(:focus) {
      border-color: #cbd5e1;
    }

    /* Password toggle styles */
    .password-wrapper {
      position: relative;
      width: 100%;
    }

    .password-wrapper input {
      width: 100%;
      padding-right: 45px;
    }

    .toggle-password {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      background: none;
      border: none;
      cursor: pointer;
      padding: 5px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #666;
      transition: color 0.3s ease;
      z-index: 10;
    }

    .toggle-password:hover {
      color: #1e3a8a;
    }

    .toggle-password svg {
      width: 20px;
      height: 20px;
    }

    /* Navy Button Styles */
    .navy-btn {
      width: 100%;
      padding: 1rem 1.5rem;
      background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
      color: #ffffff;
      border: none;
      border-radius: 0.625rem;
      font-size: 1rem;
      font-weight: 700;
      letter-spacing: 0.5px;
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: 0 4px 6px rgba(30, 58, 138, 0.25), 
                  0 1px 3px rgba(30, 58, 138, 0.15);
      position: relative;
      overflow: hidden;
    }

    .navy-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s ease;
    }

    .navy-btn:hover::before {
      left: 100%;
    }

    .navy-btn:hover {
      background: linear-gradient(135deg, #1e40af 0%, #2563eb 100%);
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(30, 58, 138, 0.3), 
                  0 2px 4px rgba(30, 58, 138, 0.2);
    }

    .navy-btn:active {
      transform: translateY(0);
      box-shadow: 0 2px 4px rgba(30, 58, 138, 0.2);
    }

    .navy-btn:disabled {
      background: linear-gradient(135deg, #cbd5e1 0%, #94a3b8 100%);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
      opacity: 0.6;
    }

    /* Loading State */
    .navy-btn.loading {
      pointer-events: none;
      position: relative;
    }

    .navy-btn.loading::after {
      content: '';
      position: absolute;
      right: 1.5rem;
      top: 50%;
      transform: translateY(-50%);
      width: 16px;
      height: 16px;
      border: 2px solid rgba(255, 255, 255, 0.3);
      border-top-color: #ffffff;
      border-radius: 50%;
      animation: spin 0.6s linear infinite;
    }

    @keyframes spin {
      to { transform: translateY(-50%) rotate(360deg); }
    }

    /* Error Message Styling */
    .navy-step-container .error-message {
      color: #dc2626;
      font-size: 0.875rem;
      font-weight: 500;
      padding: 0.5rem 0.75rem;
      background: rgba(220, 38, 38, 0.05);
      border-left: 3px solid #dc2626;
      border-radius: 0.375rem;
      margin: 0;
      display: none;
    }

    .navy-step-container .error-message.show {
      display: block;
      animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Success Message */
    .navy-step-container .success-message,
    .navy-step-container .error-message.success {
      color: #16a34a;
      background: rgba(22, 163, 74, 0.05);
      border-left-color: #16a34a;
    }
  </style>
</head>

<body>
  <div class="particles" id="particles"></div>

  <nav>
    <div class="nav-container">
      <a href="#" class="logo">LashStudio</a>
      <ul class="nav-menu" id="nav-menu">
        <li><a href="index.html" class="nav-link">Home</a></li>
        <li><a href="login.html" class="nav-link">Login</a></li>
        <li><a href="register.html" class="nav-link">Register</a></li>
      </ul>
      <div class="hamburger" id="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </nav>

  <main>
    <div class="form-container">
      <!-- Step Indicator -->
      <div class="step-indicator">
        <div class="step active" id="step-indicator-1"></div>
        <div class="step-line" id="step-line-1"></div>
        <div class="step" id="step-indicator-2"></div>
        <div class="step-line" id="step-line-2"></div>
        <div class="step" id="step-indicator-3"></div>
      </div>

      <h2>Forgot Password</h2>

      <!-- Step 1: Enter Email -->
      <div id="step-email" class="navy-step-container">
        <input type="email" id="forgotEmail" placeholder="Enter your email" required>
        <button id="sendOtpBtn" class="navy-btn">Send OTP</button>
        <p id="emailMsg" class="error-message"></p>
      </div>

      <!-- Step 2: Verify OTP -->
      <div id="step-otp" class="navy-step-container" style="display:none;">
        <input type="text" id="otpInput" placeholder="Enter OTP" maxlength="6" required>
        <button id="verifyOtpBtn" class="navy-btn">Verify OTP</button>
        <p id="otpMsg" class="error-message"></p>
      </div>

      <!-- Step 3: Reset Password -->
      <div id="step-reset" class="navy-step-container" style="display:none;">
        <div class="password-wrapper">
          <input type="password" id="newPassword" placeholder="New Password" required>
          <button type="button" class="toggle-password" data-target="newPassword" aria-label="Toggle password visibility">
            <svg class="eye-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
            </svg>
            <svg class="eye-slash-icon" style="display: none;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21" />
            </svg>
          </button>
        </div>
        <div class="password-wrapper">
          <input type="password" id="confirmPassword" placeholder="Confirm Password" required>
          <button type="button" class="toggle-password" data-target="confirmPassword" aria-label="Toggle password visibility">
            <svg class="eye-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
            </svg>
            <svg class="eye-slash-icon" style="display: none;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21" />
            </svg>
          </button>
        </div>
        <button id="resetPasswordBtn" class="navy-btn">Reset Password</button>
        <p id="resetMsg" class="error-message"></p>
      </div>

      <p class="login-link">Remember your password? <a href="login.html">Login here</a></p>
    </div>
  </main>

  <!-- <footer>
    <p>&copy; 2025 LashStudio - Premium Lash Extension Services</p>
  </footer> -->

  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="js/config.js"></script>
  <script src="js/progress.js"></script>
  <script src="js/forgot.js"></script>
  <script src="js/auth.js"></script>
  <script>
    $(document).ready(function() {
      // Initialize password toggle functionality
      initPasswordToggles();

      // Hamburger menu functionality
      $('#hamburger').on('click', function() {
        $(this).toggleClass('active');
        $('#nav-menu').toggleClass('active');
      });

      // Close menu when clicking on nav links
      $('.nav-link').on('click', function() {
        $('#hamburger').removeClass('active');
        $('#nav-menu').removeClass('active');
      });

      // Create floating particles
      function createParticles() {
        const $particlesContainer = $('#particles');
        if (!$particlesContainer.length) return;

        const particleCount = 20;

        for (let i = 0; i < particleCount; i++) {
          const $particle = $('<div>', { class: 'particle' });
          $particle.css({
            'left': Math.random() * 100 + '%',
            'width': Math.random() * 4 + 2 + 'px',
            'height': Math.random() * 4 + 2 + 'px',
            'animation-delay': Math.random() * 15 + 's',
            'animation-duration': (Math.random() * 10 + 10) + 's'
          });
          $particlesContainer.append($particle);
        }
      }

      // Initialize particles
      createParticles();

      // Step indicator management
      function updateStepIndicator(activeStep) {
        // Reset all steps
        $('.step').each(function(index) {
          $(this).removeClass('active completed');
          if (index < activeStep - 1) {
            $(this).addClass('completed');
          } else if (index === activeStep - 1) {
            $(this).addClass('active');
          }
        });

        // Update step lines
        $('.step-line').each(function(index) {
          $(this).removeClass('completed');
          if (index < activeStep - 1) {
            $(this).addClass('completed');
          }
        });
      }

      // Enhanced message display function
      function showMessage(elementId, message, type = 'error') {
        const $element = $('#' + elementId);
        if ($element.length) {
          $element.text(message);
          $element.attr('class', `error-message ${type} show`);
          setTimeout(() => {
            $element.removeClass('show');
          }, 5000);
        }
      }

      // Override the step transitions to include indicator updates
      window.showStep = function(stepName) {
        // Hide all steps
        $('#step-email').hide();
        $('#step-otp').hide();
        $('#step-reset').hide();

        // Show the requested step
        $('#' + stepName).css('display', 'flex');

        // Update step indicator
        switch (stepName) {
          case 'step-email':
            updateStepIndicator(1);
            break;
          case 'step-otp':
            updateStepIndicator(2);
            break;
          case 'step-reset':
            updateStepIndicator(3);
            // Reinitialize password toggles when step 3 becomes visible
            setTimeout(initPasswordToggles, 100);
            break;
        }
      };

      // Expose utility functions globally for forgot.js
      window.showStyledMessage = showMessage;

      // Redirect if logged in
      redirectIfLoggedIn();
    });

    // Initialize password toggle functionality
    function initPasswordToggles() {
      $('.toggle-password').off('click').on('click', function() {
        const targetId = $(this).data('target');
        const $passwordField = $('#' + targetId);
        const $eyeIcon = $(this).find('.eye-icon');
        const $eyeSlashIcon = $(this).find('.eye-slash-icon');
        
        if ($passwordField.length) {
          // Toggle the type attribute
          const type = $passwordField.attr('type') === 'password' ? 'text' : 'password';
          $passwordField.attr('type', type);
          
          // Toggle the icons
          if (type === 'password') {
            $eyeIcon.show();
            $eyeSlashIcon.hide();
          } else {
            $eyeIcon.hide();
            $eyeSlashIcon.show();
          }
        }
      });
    }
  </script>
</body>

</html>